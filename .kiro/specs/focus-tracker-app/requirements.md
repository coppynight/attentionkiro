# 需求文档

## 介绍

专注力追踪应用是一个iOS和watchOS应用，通过分析用户的日常行为习惯来评估专注程度。应用会监测用户的手机使用频率，将频繁使用手机识别为不专注行为，从而推算出用户的最长持续专注时间。应用将以美观直观的方式展示专注数据，并提供每日推送通知和桌面小组件功能。

## 需求

### 需求 1

**用户故事：** 作为一个希望提高专注力的用户，我想要应用能够自动监测我的手机使用行为，这样我就能了解自己的专注模式而无需手动记录。

#### 验收标准

1. 当用户打开手机屏幕时，系统应当记录使用开始时间
2. 当用户锁定手机屏幕时，系统应当记录使用结束时间
3. 当用户在应用间切换时，系统应当记录应用使用数据
4. 如果用户连续30分钟未使用手机，系统应当将此识别为潜在专注时段
5. 当检测到潜在专注时段时，系统应当验证是否在用户设定的活跃时间范围内
6. 如果专注时段发生在睡眠时间（如晚上11点到早上7点），系统应当排除此时段
7. 如果专注时段发生在午休时间（如中午12点到下午2点），系统应当根据用户设置决定是否计入
8. 当确认为有效专注时段时，系统应当记录专注开始和结束时间
9. 当应用进入后台时，系统应当启动后台任务以继续监测专注状态
10. 当应用在后台运行时，系统应当使用BGTaskScheduler调度后台处理任务
11. 当后台任务即将到期时，系统应当正确结束任务并调度下一次后台处理
12. 当应用重新进入前台时，系统应当检查后台期间的专注时段并保存有效数据

### 需求 2

**用户故事：** 作为用户，我想要看到我的专注时间统计和趋势，这样我就能了解自己的专注能力并追踪进步。

#### 验收标准

1. 当用户打开应用时，系统应当显示今日总专注时间
2. 当用户查看统计页面时，系统应当显示过去7天的专注时间趋势图
3. 当用户查看详细数据时，系统应当显示最长单次专注时间记录
4. 当用户查看历史数据时，系统应当显示每日专注时段的时间分布
5. 如果用户创造新的专注时间记录，系统应当高亮显示并给予鼓励

### 需求 3

**用户故事：** 作为用户，我想要在Apple Watch上也能查看专注数据，这样我就能随时了解自己的专注状态而不需要拿出手机。

#### 验收标准

1. 当用户在Apple Watch上打开应用时，系统应当显示当前专注状态
2. 当用户正在专注时，Watch应用应当显示当前专注时长
3. 当用户查看Watch应用时，系统应当显示今日专注总时长
4. 当用户在Watch上滑动时，系统应当显示过去3天的专注时间对比
5. 如果用户打断专注时段，Watch应当提供快速重新开始专注的选项

### 需求 4

**用户故事：** 作为用户，我想要收到每日专注总结通知，这样我就能保持对专注目标的关注并建立良好习惯。

#### 验收标准

1. 当每天晚上9点时，系统应当发送包含当日专注总结的推送通知
2. 当用户点击通知时，系统应当打开应用并显示详细的当日专注报告
3. 当用户连续3天达到专注目标时，系统应当发送鼓励性通知
4. 当用户专注时间比前一天减少超过30%时，系统应当发送温和的提醒通知
5. 如果用户禁用通知，系统应当尊重用户设置并停止发送通知

### 需求 5

**用户故事：** 作为用户，我想要在iPhone主屏幕上有一个小组件显示我的专注数据，这样我就能快速查看进度而不需要打开应用。

#### 验收标准

1. 当用户添加小组件到主屏幕时，系统应当显示今日专注时间和目标进度
2. 当专注时间更新时，小组件应当实时刷新显示最新数据
3. 当用户点击小组件时，系统应当打开主应用并显示详细统计
4. 当用户长按小组件时，系统应当提供快速操作选项（如开始专注模式）
5. 如果没有专注数据，小组件应当显示鼓励用户开始专注的信息

### 需求 6

**用户故事：** 作为用户，我想要应用界面美观且易于理解，这样我就能愉快地使用应用并轻松理解我的专注数据。

#### 验收标准

1. 当用户打开应用时，界面应当遵循iOS设计规范并具有现代感
2. 当显示专注数据时，系统应当使用清晰的图表和可视化元素
3. 当用户浏览不同页面时，动画过渡应当流畅自然
4. 当显示专注时间时，系统应当使用易于理解的颜色编码（绿色表示良好专注）
5. 如果用户使用深色模式，应用应当完美适配深色主题

### 需求 7

**用户故事：** 作为用户，我想要设置个人专注目标，这样我就能根据自己的需求定制专注追踪体验。

#### 验收标准

1. 当用户首次使用应用时，系统应当引导用户设置每日专注时间目标
2. 当用户修改专注目标时，系统应当保存新设置并更新相关显示
3. 当用户达到每日目标时，系统应当显示庆祝动画和鼓励信息
4. 当用户连续一周达到目标时，系统应当建议适当提高目标挑战自己
5. 如果用户多天未达到目标，系统应当建议调整为更现实的目标

### 需求 8

**用户故事：** 作为用户，我想要设置我的活跃时间和休息时间，这样应用就能准确识别真正的专注时段，而不会将睡觉或午休时间误认为专注。

#### 验收标准

1. 当用户首次设置时，系统应当提供默认的睡眠时间设置（晚上11点到早上7点）
2. 当用户修改睡眠时间时，系统应当保存设置并在专注计算中应用新的时间范围
3. 当用户启用午休排除功能时，系统应当允许设置午休时间段（默认中午12点到下午2点）
4. 当检测到在休息时间段内的手机未使用时，系统应当不将其计算为专注时间
5. 当用户查看专注统计时，系统应当显示已排除的休息时间段信息
6. 如果用户在设定的休息时间内频繁使用手机，系统应当提醒用户调整休息时间设置
7. 当用户跨时区旅行时，系统应当提供临时调整时间设置的选项

### 需求 9

**用户故事：** 作为用户，我想要应用能够在后台持续监测我的专注状态，这样即使我没有主动打开应用，它也能准确记录我的专注时间。

#### 验收标准

1. 当应用获得后台应用刷新权限时，系统应当能够在后台继续监测用户行为
2. 当应用进入后台时，系统应当启动后台任务以维持监测功能
3. 当后台任务运行时，系统应当监听应用状态变化以检测专注时段
4. 当后台任务即将到期时，系统应当调度BGProcessingTask以继续后台处理
5. 当用户长时间未使用设备时，后台任务应当能够检测到这种专注状态
6. 当应用重新进入前台时，系统应当处理后台期间检测到的专注数据
7. 当检测到重复的专注会话时，系统应当防止重复保存相同的数据
8. 如果用户禁用后台应用刷新，系统应当在应用内提示用户启用此功能以获得最佳体验